{
  "version": "1.0",
  "description": "Configuration for NIKKE sub-agent communication. Defines endpoint, auth, and fallback behavior.",
  "last_updated": "2025-11-21",

  "nikke_agent": {
    "enabled": true,
    "endpoint": "${NIKKE_AGENT_ENDPOINT}",
    "fallback_endpoint": "https://nikke-agent.whykusanagi.xyz/v1/nikke/query",
    "auth": {
      "scheme": "bearer",
      "key": "${NIKKE_AGENT_KEY}",
      "header": "Authorization: Bearer ${NIKKE_AGENT_KEY}"
    },
    "timeouts": {
      "connect_ms": 5000,
      "read_ms": 10000,
      "total_ms": 10000
    },
    "retries": {
      "max_attempts": 2,
      "backoff_ms": 1000
    },
    "fallback_behavior": {
      "enabled": true,
      "fallback_message": "The NIKKE archives are temporarily sealed. Ask again in a moment, onii-chan.",
      "log_error": true,
      "notify_admin": false
    }
  },

  "opensearch_indices": {
    "nikke_characters": {
      "name": "nikke_characters",
      "enabled": true,
      "priority": 10,
      "description": "Character database with stats, roles, tiers"
    },
    "nikke_tiers": {
      "name": "nikke_tiers",
      "enabled": true,
      "priority": 9,
      "description": "Tier lists by meta, patch, and strategy"
    },
    "nikke_guides": {
      "name": "nikke_guides",
      "enabled": true,
      "priority": 8,
      "description": "Build guides, farm routes, clear strategies"
    },
    "nikke_union_data": {
      "name": "nikke_union_data",
      "enabled": true,
      "priority": 7,
      "description": "Union-specific data (requires auth, encrypted)",
      "access_control": "authenticated_only"
    }
  },

  "query_configuration": {
    "max_tokens": 400,
    "conversation_history_messages": 3,
    "include_context": true,
    "context_fields": [
      "user_id",
      "username",
      "union_id",
      "union_name"
    ]
  },

  "response_formatting": {
    "format": "structured_json",
    "fields": [
      "characters",
      "tiers",
      "builds",
      "recommendations",
      "guides",
      "source_indices"
    ]
  },

  "health_check": {
    "enabled": true,
    "interval_seconds": 300,
    "endpoint_path": "/v1/health",
    "timeout_ms": 5000
  },

  "monitoring": {
    "log_requests": true,
    "log_responses": false,
    "log_errors": true,
    "metrics": ["latency_ms", "tokens_used", "error_rate"]
  }
}
